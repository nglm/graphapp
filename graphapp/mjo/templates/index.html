{% extends "base.html" %}

{% load static %}

{% block content %}

    <!-- buttons -->
    <script type="module">
        import {
            clearSelection, clearStoredSelection,
            selectOption, updateSliderValue, sliderMember,
        } from "{% static './interact.js' %}";
        import {redraw_relevant_graph} from "{% static './plots.js' %}";
        import {add_legend} from "{% static './figures.js' %}"
        globalThis.clearSelection = clearSelection;
        globalThis.clearStoredSelection = clearStoredSelection;
        globalThis.selectOption = selectOption;
        globalThis.updateSliderValue = updateSliderValue;
        globalThis.sliderMember = sliderMember;
        globalThis.redraw_relevant_graph = redraw_relevant_graph;
        globalThis.add_legend = add_legend;
    </script>

    <div class="top-bar">
        {% with "File" as option_title %}
        {% with "files" as option_name %}
        {% with filenames as options %}
        {% with filename as option %}
        {% include "select.html" %}
        {% endwith %}
        {% endwith %}
        {% endwith %}
        {% endwith %}

        {% with "Clustering method" as option_title %}
        {% with "methods" as option_name %}
        {% with methods as options %}
        {% with method as option %}
        {% include "select.html" %}
        {% endwith %}
        {% endwith %}
        {% endwith %}
        {% endwith %}

        {% with "Clustering score" as option_title %}
        {% with "scores" as option_name %}
        {% with scores as options %}
        {% with score as option %}
        {% include "select.html" %}
        {% endwith %}
        {% endwith %}
        {% endwith %}
        {% endwith %}

        {% with "Data representation" as option_title %}
        {% with "data_representation" as option_name %}
        {% with drepresentations as options %}
        {% with drepresentation as option %}
        {% include "select.html" %}
        {% endwith %}
        {% endwith %}
        {% endwith %}
        {% endwith %}

        {% with "Time representation" as option_title %}
        {% with "time_representation" as option_name %}
        {% with trepresentations as options %}
        {% with trepresentation as option %}
        {% include "select.html" %}
        {% endwith %}
        {% endwith %}
        {% endwith %}
        {% endwith %}

        <span class="slider-container" >
            <span style="font-weight: bold;"> Time window (x6h):   </span>
            <span id="time_window" class="slider-value"> 3 </span>
            <input
                id="windows" type="range" class="slider-range"
                onchange="selectOption()" oninput="updateSliderValue('windows', 'time_window')"
                step="1" value="1" min="1" max="50"
            >
        </span>
    </div>



    <div id="all-plots">
        {% include "plots.html" %}
    </div>

    <div id="right-bar" class="right-bar">

        <div id="legend" class="legend right-bar-elem">
            <h4>Legend</h4>
            number of clusters:
            <script type="module">
                add_legend();
            </script>
            <br>
        </div>

        <div class="button-container right-bar-elem">
            <br>
            <div class="button"
            onclick="clearSelection(); clearStoredSelection()">
                Clear selection
            </div>
        </div>

        <div class="button-container right-bar-elem">
            <div class="button" onclick="redraw_relevant_graph()">
                Default k values
            </div>
        </div>

        <div class="slider-container right-bar-elem">
            <br>
            <fieldset>
                <legend><h4>Type of selection</h4></legend>

                <div>
                    <input type="checkbox" id="check-intersection" name="check-intersection" m_ids = "-1" checked>
                    <label for="check-intersection">Intersection</label>
                </div>

                <div>
                    <input type="checkbox" id="check-accumulation" name="check-accumulation" m_ids = "-1">
                    <label for="check-accumulation">Accumulation</label>
                </div>
            </fieldset>
        </div>

        <div class="slider-container right-bar-elem">
            <br>
            <h4>Selected member:</h4>
            <span id="member_selected" class="slider-value">
                0
            </span>
            <input
                id="members_range" type="range" class="slider-range"
                oninput="
                    updateSliderValue('members_range', 'member_selected');
                    sliderMember('lineHovered');
                    "
                onchange="sliderMember('lineClicked');"
                step="1" value="0" min="0" max="49"
            >
            <div><br><h4>Intersection of <br> selected clusters:</h4></div>
            <div id="intersection" class="slider-value">
            </div>
            <br>
            <div><h4>In each <br> selected cluster:<h4></div>
                <ol id="accumulation" type="A" >
                    <!-- <li id="accumulation1"></li> -->
                </ol>
            </div>
            <br>
        </div>
    </div>




{% endblock content %}